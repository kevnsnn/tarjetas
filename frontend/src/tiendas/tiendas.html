<!-- Accesos -->
<div class="homeContent" layout="column" layout-fill layout-align="start center">
  <md-toolbar md-scroll-shrink>
    <div class="md-toolbar-tools" layout="row" layout-align="space-between center">
      <div layout="row" layout-align="space-around center">
        <img ng-src="{{ $ctrl.icon }}" class="icon"/>
        <span class="title"><b>TARJETA</b></span>
      </div>
      <div layout="row" layout-align="start">
        <span style="margin-top: 10px" class="subtitle"><sup><em>¡Gestiona tus compras!</em></sup></span>
      </div>
      <div layout="row">
        <span style="margin-top: 10px" class="subtitle"><sup>Tienda: {{ $ctrl.user }}</sup></span>
        <!-- Fab Speed dial -->
        <div style="margin-top: 14px">
          <md-fab-speed-dial class="md-scale" md-direction="left">
            <md-fab-trigger>
              <md-button class="md-fab md-mini md-warn">
                <md-icon class="material-icons" md-colors="{color: 'primary-50'}">more_vert</md-icon>
              </md-button>
            </md-fab-trigger>
            <!-- Actions fab speed dial-->
            <md-fab-actions>
              <md-button class="md-fab md-mini md-warn md-hue-3" ng-click="$ctrl.exit()">
                <md-icon class="material-icons" md-colors="{color: 'primary-50'}">exit_to_app</md-icon>
              </md-button>
              <md-button class="md-fab md-mini md-warn md-hue-1" ng-show="!$ctrl.isSettings" ng-click="$ctrl.isSettings = true">
                <md-icon class="material-icons" md-colors="{color: 'primary-50'}">settings</md-icon>
              </md-button>
              <md-button class="md-fab md-mini md-warn md-hue-1" ng-show="$ctrl.isSettings" ng-click="$ctrl.isSettings = false">
                <md-icon class="material-icons" md-colors="{color: 'primary-50'}">shop</md-icon>
              </md-button>
            </md-fab-actions>
          </md-fab-speed-dial>
        </div>
      </div>
    </div>
  </md-toolbar>
  <div layout="row" layout-align="center center" class="animate-hide" ng-hide="$ctrl.isSettings">
    <md-button class="md-raised md-accent md-hue-2" ng-click="$ctrl.registrar(0)">Registro de compras</md-button>
    <md-button class="md-raised md-accent md-shade-3" ng-click="$ctrl.registrar(1)">Historial de compras</md-button>      
  </div>
  <div class="animate-hide" ng-show="$ctrl.isAction && $ctrl.isRegistro && !$ctrl.isSettings && !$ctrl.newCompra" layout="column">
    <div layout="row" class="animate-hide-search-b" ng-hide="!$ctrl.isSearchingC || $ctrl.selectedC.length">
      <form style="max-height: 40px">
        <md-input-container md-no-float>
          <input style="min-width: 1050px" ng-model="$ctrl.searchTextC" type="text" placeholder="Buscar...">
        </md-input-container>
      </form>
      <md-button class="md-fab md-mini md-warn md-hue-1" ng-click="$ctrl.isSearchingC = false">
        <md-icon class="material-icons" md-colors="{color: 'primary-50'}">undo</md-icon>
      </md-button>
    </div>
    <div ng-hide="$ctrl.isSearchingC || $ctrl.selectedC.length" class="animate-hide-search-a">
      <md-button class="md-fab md-mini md-warn md-hue-1" ng-click="$ctrl.isSearchingC = true">
        <md-icon class="material-icons" md-colors="{color: 'primary-50'}">search</md-icon>
      </md-button>
    </div>
    <div layout="row" class="animate-hide-search-b" ng-hide="!$ctrl.selectedC.length" style="min-height: 52px">
      <md-button class="md-raised md-warn md-hue-1" ng-click="$ctrl.newCompra = true; $ctrl.numTarjeta = $ctrl.selectedC[0].numTarjeta">Registrar compra</md-button>
    </div>
    <md-table-container>
      <table id="findTarjetasResult" md-table ng-model="$ctrl.selectedC" md-row-select>
        <thead md-head md-order="numTarjeta">
          <tr md-row>
            <th md-column md-numeric md-order-by="numTarjeta"><span>Número de tarjeta</span></th>
            <th md-column md-numeric md-order-by="nombre"><span>Nombre</span></th>
            <th md-column md-numeric md-order-by="primerApellido"><span>Primer apellido</span></th>                                    
            <th md-column md-numeric md-order-by="segundoApellido"><span>Segundo apellido</span></th>                                    
            <th md-column md-numeric md-order-by="direccion"><span>Dirección</span></th>                                    
            <th md-column md-numeric md-order-by="telefono"><span>Teléfono</span></th>                                    
            <th md-column md-numeric md-order-by="email"><span>email</span></th>                                    
          </tr>
        </thead>
        <tbody md-body>
          <tr md-row md-select="tarjeta" md-select-id="_id" md-auto-select
          ng-repeat="tarjeta in $ctrl.filterTarjetas = ($ctrl.tarjetas | orderBy: numTarjeta | filter: $ctrl.searchTextC) | limitTo: $ctrl.query.limit: ($ctrl.query.page - 1) * $ctrl.query.limit">
            <td md-cell>{{tarjeta.numTarjeta}}</td>
            <td md-cell>{{tarjeta.nombre}}</td>
            <td md-cell>{{tarjeta.primerApellido}}</td>
            <td md-cell>{{tarjeta.segundoApellido}}</td>
            <td md-cell>{{tarjeta.direccion}}</td>
            <td md-cell>{{tarjeta.telefono}}</td>
            <td md-cell>{{tarjeta.email}}</td>
          </tr>
        </tbody>
      </table>
    </md-table-container>
    <md-table-pagination md-limit="$ctrl.query.limit" md-limit-options="[5, 10, 15]" md-page="$ctrl.query.page" md-total="{{$ctrl.filterTarjetas.length}}" md-page-select></md-table-pagination>
  </div>
  <div layout="column" class="box formTarjeta animate-hide" ng-show="$ctrl.isAction && $ctrl.isRegistro && !$ctrl.isSettings && $ctrl.newCompra" layout-align="center">
    <div layout="row">
      <h2 class="registroTitle">Registro de compras</h2>
      <div class="xButton">
        <md-button class="md-warn md-hue-1" ng-click="$ctrl.newCompra = false">
          <md-icon class="material-icons" md-colors="{color: 'primary-50'}">clear</md-icon>
        </md-button>
      </div>
    </div>
    <form ng-submit="$ctrl.registrarCompra()">
      <md-input-container md-no-float class="md-block">
        <md-icon class="material-icons md-light">credit_card</md-icon>
        <input ng-disabled="true" style="color: white" ng-model="$ctrl.numTarjeta" type="text" placeholder="Número de tarjeta de socio" id="phGrey">
      </md-input-container>
      <md-input-container md-no-float class="md-block">
        <md-icon class="material-icons md-light">euro_symbol</md-icon>        
        <input style="color: white" ng-model="$ctrl.importe" type="text" placeholder="Importe de compra" id="phGrey">
      </md-input-container>
      <md-button type="submit" class="md-raised md-warn">Registrar</md-button>
    </form>
  </div>
  <div class="animate-hide" ng-show="$ctrl.isAction && $ctrl.isHistorial && !$ctrl.isSettings" layout="column">
    <div layout="row" class="animate-hide-search-b" ng-hide="!$ctrl.isSearchingH">
      <form style="max-height: 40px">
        <md-input-container md-no-float>
          <input style="min-width: 580px" ng-model="$ctrl.searchTextH.numTarjeta" type="text" placeholder="Buscar...">
        </md-input-container>
      </form>
      <md-button class="md-fab md-mini md-warn md-hue-1" ng-click="$ctrl.isSearchingH = false">
        <md-icon class="material-icons" md-colors="{color: 'primary-50'}">undo</md-icon>
      </md-button>
    </div>
    <div ng-hide="$ctrl.isSearchingH" class="animate-hide-search-a">
      <md-button class="md-fab md-mini md-warn md-hue-1" ng-click="$ctrl.isSearchingH = true">
        <md-icon class="material-icons" md-colors="{color: 'primary-50'}">search</md-icon>
      </md-button>
    </div>
    <md-table-container>
      <table id="findComprasResult" md-table ng-model="$ctrl.selectedH">
        <thead md-head md-order="fecha">
          <tr md-row>
            <th md-column md-numeric md-order-by="numTarjeta"><span>Número de tarjeta</span></th>
            <th md-column md-numeric md-desc md-order-by="fecha"><span>Fecha (Mes-día-año @ horas:min::seg)</span></th>                                    
            <th md-column md-numeric md-order-by="importe"><span>Importe (€)</span></th>
          </tr>
        </thead>
        <tbody md-body>
          <tr md-row md-select="compra" md-select-id="_id" md-auto-select
          ng-repeat="compra in $ctrl.filterCompras = ($ctrl.compras | orderBy: fecha | filter: $ctrl.searchTextH) | limitTo: $ctrl.query.limit: ($ctrl.query.page - 1) * $ctrl.query.limit">
            <td md-cell>{{compra.numTarjeta}}</td>
            <td md-cell>{{compra.fecha | date:'MMM-dd-yyyy @ HH:mm::ss'}}</td>                        
            <td md-cell>{{compra.importe}}</td>
          </tr>
        </tbody>
      </table>
    </md-table-container>
    <md-table-pagination md-limit="$ctrl.query.limit" md-limit-options="[5, 10, 15]" md-page="$ctrl.query.page" md-total="{{$ctrl.filterCompras.length}}" md-page-select></md-table-pagination>
  </div>
  <div layout="column" style="margin-top: 10px" class="box formTarjeta animate-hide" ng-show="$ctrl.isSettings" layout-align="center">
    <h2 class="registroTitle">Modifica tus datos</h2>
    <!-- Formulario tiendas -->
    <form ng-submit="$ctrl.modificarTienda()">
      <div layout="row">
      <!-- Input nombre -->
      <md-input-container md-no-float class="md-block">
        <md-icon class="material-icons md-light">shop</md-icon>
        <input style="color: white" ng-disabled="true" ng-model="$ctrl.nombreTienda" type="text" placeholder="Nombre de la tienda" id="phGrey">
      </md-input-container>
        <!-- Input primerApellido -->
        <md-input-container md-no-float class="md-block">
        <md-icon class="material-icons md-light">home</md-icon>
          <input style="color: white" ng-model="$ctrl.direccionTienda" type="text" placeholder="Dirección" id="phGrey">
        </md-input-container>
        <!-- Input segundoApellido -->
        <md-input-container md-no-float class="md-block">
        <md-icon class="material-icons md-light">phone</md-icon>
          <input style="color: white" ng-model="$ctrl.telefonoTienda" type="text" placeholder="Teléfono" id="phGrey">
        </md-input-container>
        </div>
      <!-- Boton submit del formulario -->
      <md-button type="submit" id="regTienda" class="md-raised md-warn">Modificar</md-button>
      <md-button type="button" id="elimTienda" ng-click="$ctrl.eliminarCuenta($event)" class="md-warn">Eliminar Cuenta</md-button>      
    </form>
  </div>
</div>





